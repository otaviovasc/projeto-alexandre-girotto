<h1>Available Items</h1>
<br>
<div class="service-cards-container">
  <% @items.each do |item| %>
    <div class="service-card">
      <div class="service-image">
        <% if item.image.attached? %>
            <img src="<%=item.image.url%>" alt="" class="" style="max-height: 200px; max-width: 200px">
        <% else %>
          <p>No Image Available</p>
        <% end %>
      </div>
      <div class="service-details">
        <h2><%= item.name %></h2>
        <p><%= item.description %></p>
        <p><strong>Price:</strong> <%= number_to_currency(item.price) %></p>
      </div>


      <div class="service-actions">
        <%= link_to 'View Service', item_path(item) %>
      </div>
    </div>
  <% end %>
</div>

<h2>Your Cart</h2>

<% if @cart_items.present? %>
  <% @cart_items.each do |cart_item| %>
    <div class="cart-item">
      <h4><%= cart_item.item&.name || cart_item.service&.name %></h4>
      <p>Price: <%= number_to_currency(cart_item.item&.price || cart_item.service&.price) %></p>

      <%= form_with url: add_item_path, method: :post, local: true do |f| %>
        <%= hidden_field_tag :item_id, cart_item.item_id if cart_item.item.present? %>
        <%= hidden_field_tag :service_id, cart_item.service_id if cart_item.service.present? %>
        <%= number_field_tag :quantity, cart_item.quantity, min: 1 %>
        <%= submit_tag "Update Quantity", class: "btn btn-secondary" %>
      <% end %>

      <%= button_to "Remove", remove_item_path(cart_item), method: :delete, class: "btn btn-danger" %>
    </div>
  <% end %>

  <%= link_to 'Go to Checkout', checkout_cart_path, class: "btn btn-primary" %>
<% else %>
  <p>Your cart is empty.</p>
<% end %>

<style>
  .marketplace-items {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1.5rem;
  }

  .item-card, .cart-item {
    border: 1px solid #ccc;
    padding: 1rem;
    border-radius: 8px;
    background-color: #f9f9f9;
  }

  .item-card h3, .cart-item h4 {
    margin-bottom: 0.5rem;
  }

  .cart-item {
    margin-bottom: 1rem;
  }

</style>
